# Project Context: Chess FEN Analyzer

## Project Overview
**Chess FEN Analyzer** is a web application designed to analyze chess positions using FEN (Forsythâ€“Edwards Notation) and the Stockfish chess engine. It is a static site with serverless backend functions hosted on Netlify.

## Tech Stack
*   **Frontend:** HTML5, CSS (embedded), JavaScript (Vanilla)
*   **Libraries (CDN):** jQuery 3.6.0, ChessboardJS 1.0.0, Chess.js 0.10.3
*   **Engine:** Stockfish (WASM/JS) running in a Web Worker
*   **Backend:** Netlify Functions (Node.js)
*   **Hosting/Runtime:** Netlify

## Building and Running

### Prerequisites
*   Node.js and npm
*   Netlify CLI (recommended for local development)

### Commands
*   **Start Local Dev Server:**
    ```bash
    npm run dev
    # OR
    netlify dev
    ```
*   **Build:**
    ```bash
    npm run build
    # Note: No build step is required (static site), simply outputs "No build required".
    ```

## Architecture & Conventions

### Directory Structure
*   `app.js`: Main frontend logic (Board control, Engine communication, State management).
*   `index.html`: Main entry point (SPA structure).
*   `stockfish/`: Contains the Stockfish engine files (`stockfish.js`, `stockfish.wasm`).
*   `netlify/functions/`: Backend serverless functions (e.g., `favorites.js`).

### Data Flow
1.  **Input:** Users upload a file containing FEN strings.
2.  **Processing:** The app parses FENs and stores them in a `positions` array.
3.  **Interaction:** Users navigate positions; `chessboard.js` renders the board; `chess.js` handles move validation.
4.  **Analysis:** The app sends the current FEN to the Stockfish Web Worker via the UCI protocol. Analysis results update the UI.
5.  **Persistence:** "Favorites" are managed via the `favorites.js` Netlify function (REST API).

### Key Patterns
*   **Stockfish Integration:** Communicates via standard Web Worker message passing using the UCI (Universal Chess Interface) protocol.
*   **Evaluation:** Score is calculated based on centipawns and visualized via a progress bar.
*   **Favorites ID:** Generated by base64 encoding the FEN string (truncated to 16 chars).
*   **State Management:** Global variables in `app.js` handle app state (current position index, move history, etc.).

## Important Files
*   `CLAUDE.md`: Contains detailed architectural notes and patterns (Primary reference).
*   `netlify.toml`: Netlify configuration.
*   `package.json`: Project dependencies and scripts.
